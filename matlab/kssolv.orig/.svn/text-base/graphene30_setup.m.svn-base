%
% construct a small piece of graphene
%

%
% 1. construct atoms
%
a1 = Atom('C');
a2 = Atom('H');
for j = 1:23
  atomlist(j) = a1;
end;
atomlist(24) = a2;
for j = 25:28
  atomlist(j) = a1; 
end;
for j = 29:31
  atomlist(j) = a2;
end;
for j = 32:34
  atomlist(j) = a1;
end;
for j = 35:44
  atomlist(j) = a2;
end;
%
% 2. set up the supercell
%
C = [40 0 0; 0 40 0; 0 0 5];
%
% 3. define the coordinates the atoms 
%
xyzlist = [
 0.000000 0.000000 0.000000
 -1.230622 -0.710500 0.000000
 0.000000 1.421000 0.000000
 1.230622 -0.710500 0.000000
 -2.461244 0.000000 0.000000
 -1.230622 2.131500 0.000000
 -1.230622 -2.131500 0.000000
 1.230622 2.131500 0.000000
 1.230622 -2.131500 0.000000
 2.461244 0.000000 0.000000
 0.000000 -2.842000 0.000000
 -2.461244 1.421000 0.000000
 2.461244 1.421000 0.000000
 -3.691866 -0.710500 0.000000
 -1.230622 3.552500 0.000000
 -2.461244 -2.842000 0.000000
 1.230622 3.552500 0.000000
 2.461244 -2.842000 0.000000
 3.691866 -0.710500 0.000000
 -3.691866 2.131500 0.000000
 -3.691866 -2.131500 0.000000
 0.000000 4.263000 0.000000
 0.000000 -4.263000 0.000000
 3.403480 1.965000 0.000000
 3.691866 -2.131500 0.000000
 -4.922488 0.000000 0.000000
 -2.461244 4.263000 0.000000
 -2.461244 -4.263000 0.000000
 2.172858 4.096500 0.000000
 2.461244 -3.930000 0.000000
 4.634102 -0.166500 0.000000
 -4.922488 1.421000 0.000000
 -3.691866 3.552500 0.000000
 -1.230622 -4.973500 0.000000
 0.942236 -4.807000 0.000000
 -4.634102 -2.675500 0.000000
 0.000000 5.351000 0.000000
 4.634102 -2.675500 0.000000
 -5.864724 -0.544000 0.000000
 -2.461244 5.351000 0.000000
 -3.403480 -4.807000 0.000000
 -5.864724 1.965000 0.000000
 -4.634102 4.096500 0.000000
 -1.230622 -6.061500 0.000000
]/0.529177;
%
% 4. Configure the molecule (crystal)
%
mol = Molecule();
mol = set(mol,'supercell',C);
mol = set(mol,'atomlist',atomlist);
mol = set(mol,'xyzlist' ,xyzlist);
mol = set(mol,'ecut',20);  % kinetic energy cut off
mol = set(mol,'name','graphite'); 
ierr = finalize(mol);
if (ierr ~=0)
   fprintf('Error in the molecule setup\n');
end;

